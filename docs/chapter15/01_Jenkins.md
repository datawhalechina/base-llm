# ç¬¬ä¸€èŠ‚ æ­å»º Jenkins CI/CD è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿

ä¸Šä¸€ç« ï¼Œæˆ‘ä»¬æˆåŠŸåˆ©ç”¨ Docker å’Œ Docker Compose å°† NER æ¨¡å‹æœåŠ¡è¿›è¡Œäº†å®¹å™¨åŒ–å°è£…ã€‚å®ç°äº†â€œä¸€æ¬¡æ„å»ºï¼Œéšå¤„è¿è¡Œâ€çš„ç›®æ ‡ï¼Œç¼“è§£äº†ç¯å¢ƒä¸ä¸€è‡´çš„é—®é¢˜ã€‚

ä½†æ˜¯ï¼Œéšç€ä¸šåŠ¡å‘å±•ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä»£ç æ¯å¤©éƒ½åœ¨æ›´æ–°ã€‚æ¯æ¬¡ä¿®æ”¹å®Œä»£ç ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨åœ¨æœ¬åœ°æ„å»ºé•œåƒã€æ¨é€åˆ°æœåŠ¡å™¨ã€ç™»å½•æœåŠ¡å™¨ã€åœæ­¢æ—§å®¹å™¨ã€å¯åŠ¨æ–°å®¹å™¨â€¦â€¦å¦‚æœåƒæŸäº›äº’è”ç½‘å¤§å‚é‚£æ ·ï¼Œä¸€å¤©éœ€è¦å‘ç‰ˆåå‡ æ¬¡ï¼Œæˆ–è€…æœåŠ¡å™¨é›†ç¾¤æœ‰å‡ åå°ï¼Œè¿™ç§æ‰‹åŠ¨æ“ä½œçš„æ–¹å¼æ˜¾ç„¶æ•ˆç‡æä½ï¼Œè€Œä¸”ä¸€æ—¦æ“ä½œå¤±è¯¯ï¼ˆæ¯”å¦‚è¯¯åˆ æ–‡ä»¶ã€è¦†ç›–äº†é”™è¯¯ç‰ˆæœ¬ï¼‰ï¼Œå›æ»šèµ·æ¥ä¹Ÿå¼‚å¸¸ç—›è‹¦ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¼ä¸šé€šå¸¸ä¼šå»ºè®¾ä¸€å¥— **CI/CDï¼ˆæŒç»­é›†æˆ/æŒç»­å‘å¸ƒï¼‰** å¹³å°ã€‚æœ¬ç« æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•å¼•å…¥ **Git** å’Œ **Jenkins**ï¼Œå°†å¼€å‘å’Œè¿ç»´ç»“åˆèµ·æ¥ï¼Œå®ç°ä»£ç ä¸€ç»æäº¤ï¼Œè‡ªåŠ¨è§¦å‘æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²çš„â€œæ™ºèƒ½æµæ°´çº¿â€ã€‚

## ä¸€ã€DevOps ä¸ CI/CD æ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯ DevOpsï¼Ÿ

åœ¨äº†è§£å…·ä½“çš„å·¥å…·ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£å…¶èƒŒåçš„æ ¸å¿ƒæ€æƒ³â€”â€”**DevOps**ã€‚DevOps æ˜¯ Developmentï¼ˆå¼€å‘ï¼‰å’Œ Operationsï¼ˆè¿ç»´ï¼‰ä¸¤ä¸ªè¯çš„ç»„åˆã€‚è½¯ä»¶å¼€å‘æ¨¡å¼ç»å†äº†å¥½å‡ ä¸ªæ—¶ä»£çš„æ¼”è¿›ï¼Œç†è§£è¿™ä¸ªè¿‡ç¨‹æœ‰åŠ©äºæˆ‘ä»¬æ˜ç™½ä¸ºä»€ä¹ˆç°åœ¨éœ€è¦ DevOpsã€‚

-  **åŸå§‹æ—¶ä»£ï¼ˆä¸ªäººç»éªŒé©±åŠ¨ï¼Œ1950s-1960sï¼‰ï¼š**
   åœ¨è®¡ç®—æœºå‘å±•çš„æ—©æœŸï¼Œè½¯ä»¶å¼€å‘å®Œå…¨ä¾èµ–ç¨‹åºå‘˜çš„ä¸ªäººèƒ½åŠ›ã€‚æ²¡æœ‰ç»Ÿä¸€çš„æµç¨‹å’Œæ ‡å‡†ï¼Œå¤§å®¶éƒ½æ˜¯â€œå†™å®Œå°±æ”¹â€ï¼ˆCode and Fixï¼‰ã€‚è¿™ç§æ¨¡å¼åƒä¸ªæ‰‹å·¥ä½œåŠï¼Œé«˜åº¦ä¾èµ–ä¸ªäººï¼Œä¸€æ—¦æ ¸å¿ƒäººå‘˜ç¦»èŒï¼Œé¡¹ç›®å¾€å¾€å°±ä¼šé™·å…¥æ··ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•ã€‚

-  **ç€‘å¸ƒæ¨¡å‹ï¼ˆçº¿æ€§æµç¨‹ï¼Œ1970s-1990sï¼‰ï¼š**
   ä¸ºäº†è§£å†³æ··ä¹±ï¼Œäººä»¬å€Ÿé‰´äº†å»ºç­‘å·¥ç¨‹çš„ç®¡ç†æ–¹æ³•ï¼Œå¼•å…¥äº†**ç€‘å¸ƒæ¨¡å‹**ã€‚å®ƒå°†å¼€å‘è¿‡ç¨‹åˆ’åˆ†ä¸ºéœ€æ±‚ã€è®¾è®¡ã€ç¼–ç ã€æµ‹è¯•ã€ç»´æŠ¤ç­‰ä¸¥æ ¼çš„é˜¶æ®µï¼Œå‰ä¸€ä¸ªé˜¶æ®µå®Œæˆåæ‰èƒ½è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚è¿™è™½ç„¶å¸¦æ¥äº†è§„èŒƒï¼Œä½†è¿‡äºåƒµåŒ–ã€‚å°±åƒåšä¸€å¼ æ¡Œå­ï¼Œå¦‚æœåœ¨æœ€åéªŒæ”¶æ—¶å‘ç°è®¾è®¡å›¾çº¸ä¸€å¼€å§‹å°±ç”»é”™äº†ï¼Œè¦ä¿®æ”¹å°±å¿…é¡»æ¨å€’é‡æ¥ï¼Œæˆæœ¬æé«˜ã€‚

-  **æ•æ·å¼€å‘ï¼ˆå°æ­¥å¿«è·‘ï¼Œ1990s-2000sï¼‰ï¼š**
   ä¸ºäº†åº”å¯¹éœ€æ±‚é¢‘ç¹å˜æ›´ï¼Œ**æ•æ·å¼€å‘**ï¼ˆAgileï¼‰å‡ºç°äº†ã€‚å®ƒä¸å†è¿½æ±‚ä¸€æ¬¡æ€§äº¤ä»˜å®Œç¾çš„æˆå“ï¼Œè€Œæ˜¯å¼ºè°ƒ**è¿­ä»£**ã€‚å…ˆæŠŠæœ€æ ¸å¿ƒçš„åŠŸèƒ½åšå‡ºæ¥ï¼ˆæ¯”å¦‚å…ˆåšä¸€ä¸ªèƒ½ç”¨çš„æ¡Œå­è…¿ï¼‰ï¼Œç»™ç”¨æˆ·çœ‹ï¼Œæ ¹æ®åé¦ˆå¿«é€Ÿè°ƒæ•´ï¼Œå†åšä¸‹ä¸€ä¸ªæ¨¡å—ã€‚å°±åƒæŠŠä¸€ä¸ªå¤§é¡¹ç›®æ‹†æˆäº†æ— æ•°ä¸ªå°å‘¨æœŸï¼ˆSprintï¼‰ï¼Œæ¯ä¸ªå‘¨æœŸéƒ½èƒ½äº¤ä»˜å¯ç”¨çš„è½¯ä»¶ï¼Œå¤§å¤§æé«˜äº†çµæ´»æ€§ã€‚

-  **DevOpsï¼ˆæ™ºèƒ½æµæ°´çº¿ï¼Œ2000s-è‡³ä»Šï¼‰ï¼š**
   ç°åœ¨çš„ DevOps åˆ™æ˜¯æ›´è¿›ä¸€æ­¥ï¼Œå®ƒæ‰“ç ´äº†å¼€å‘å’Œè¿ç»´ä¹‹é—´çš„éš”é˜‚ã€‚åœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œå¼€å‘åªç®¡å†™ä»£ç ï¼Œè¿ç»´åªç®¡éƒ¨ç½²ï¼Œä¸­é—´å®¹æ˜“æ‰¯çš®ã€‚DevOps é€šè¿‡**è‡ªåŠ¨åŒ–å·¥å…·é“¾**ï¼ˆCI/CDï¼‰å°†å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²ç´§å¯†è¿æ¥ã€‚å¼€å‘äººå‘˜åªéœ€æäº¤ä»£ç ï¼Œå¹³å°å°±ä¼šè‡ªåŠ¨å®Œæˆæ„å»ºã€æµ‹è¯•ã€å‘å¸ƒç­‰åç»­æ‰€æœ‰å·¥ä½œã€‚è¿™å°±åƒä¸€æ¡æ™ºèƒ½çš„æµæ°´çº¿ï¼Œä¸ä»…ç”Ÿäº§æ•ˆç‡é«˜ï¼Œè¿˜èƒ½å®æ—¶ç›‘æ§ã€å¿«é€Ÿä¿®å¤ï¼Œè®©è½¯ä»¶äº¤ä»˜å˜å¾—åƒâ€œå·¥å‚æµæ°´çº¿â€ä¸€æ ·æ ‡å‡†å’Œé«˜æ•ˆã€‚

### 1.2 CI/CD çš„æ ¸å¿ƒä»·å€¼

CI/CD æ˜¯ DevOps ç†å¿µè½åœ°çš„å…³é”®å®è·µï¼Œå®ƒé€šè¿‡å°†è½¯ä»¶å¼€å‘ä¸­çš„æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ç­‰ç¯èŠ‚è‡ªåŠ¨åŒ–ï¼Œæå¤§åœ°æå‡äº†ç ”å‘æ•ˆç‡å’Œè´¨é‡ã€‚

1. **CI (Continuous Integrationï¼ŒæŒç»­é›†æˆ)**

å¼€å‘äººå‘˜é¢‘ç¹åœ°å°†ä»£ç é›†æˆåˆ°å…±äº«çš„ä¸»å¹²åˆ†æ”¯ã€‚**æ¯æ¬¡æäº¤ä»£ç åï¼Œç³»ç»Ÿè‡ªåŠ¨è§¦å‘æ„å»ºï¼ˆBuildï¼‰å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆTestï¼‰**ã€‚é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•çš„å¿«é€Ÿåé¦ˆï¼Œé¿å…åœ¨é¡¹ç›®åæœŸæ‰å‘ç°å¤§é‡å†²çªå’Œé”™è¯¯çš„â€œé›†æˆåœ°ç‹±â€ï¼ˆIntegration Hellï¼‰ã€‚åŒæ—¶ï¼Œå¼ºåˆ¶çš„ä»£ç è§„èŒƒæ£€æŸ¥å’Œå•å…ƒæµ‹è¯•ï¼Œä¿è¯åˆå…¥ä¸»å¹²çš„ä»£ç æ˜¯â€œå¥åº·â€çš„ï¼Œæ˜¾è‘—**æé«˜ä»£ç è´¨é‡**ï¼Œå¹¶è®©å›¢é˜Ÿæˆå‘˜é€šè¿‡æ„å»ºçŠ¶æ€å®æ—¶äº†è§£é¡¹ç›®çš„å¥åº·ç¨‹åº¦ï¼Œå¢å¼ºå¼€å‘çš„**é€æ˜åº¦**ã€‚

2. **CD (Continuous Delivery/Deploymentï¼ŒæŒç»­äº¤ä»˜/éƒ¨ç½²)**

åœ¨æŒç»­é›†æˆçš„åŸºç¡€ä¸Šï¼Œå°†ä»£ç è‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒç”šè‡³ç”Ÿäº§ç¯å¢ƒã€‚å®ƒæ¶µç›–äº†è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ç¯å¢ƒé…ç½®ç®¡ç†å’Œå‘å¸ƒæµç¨‹ç¼–æ’ã€‚è¿™ä¸€è¿‡ç¨‹çš„ä»·å€¼åœ¨äº**ç¼©çŸ­ä¸Šå¸‚æ—¶é—´**ï¼ˆTime to Marketï¼‰ï¼Œä»£ç ä»å¼€å‘å®Œæˆåˆ°ä¸Šçº¿çš„æ—¶é—´è¢«å‹ç¼©åˆ°æœ€çŸ­ï¼Œä½¿ä¼ä¸šèƒ½å¿«é€Ÿå“åº”å¸‚åœºå˜åŒ–ã€‚è€Œä¸”ï¼Œç”±äºå‘å¸ƒé¢‘ç‡é«˜ï¼Œæ¯æ¬¡å‘å¸ƒçš„å˜æ›´é‡å°ï¼Œå³ä½¿å‡ºé—®é¢˜ä¹Ÿå®¹æ˜“æ’æŸ¥å’Œå›æ»šï¼Œä»è€Œå¤§å¹…**é™ä½äº†å‘å¸ƒé£é™©**ã€‚è¿™ä¹ŸæŠŠè¿ç»´äººå‘˜ä»ç¹çã€æ˜“é”™çš„ç†¬å¤œæ‰‹åŠ¨å‘ç‰ˆä¸­**è§£æ”¾å‡ºæ¥**ï¼Œè®©æœºå™¨è‡ªåŠ¨æ‰§è¡Œæ ‡å‡†åŒ–æµç¨‹ã€‚

ç®€è€Œè¨€ä¹‹ï¼ŒCI/CD å°±åƒä¸€ä¸ª**ä¸çŸ¥ç–²å€¦çš„æ™ºèƒ½ç®¡å®¶**ã€‚å®ƒåœ¨ä¿è¯è´¨é‡çš„å‰æä¸‹ï¼Œè®©è½¯ä»¶äº¤ä»˜å˜å¾—åƒâ€œå·¥å‚æµæ°´çº¿â€ä¸€æ ·æ ‡å‡†ã€é«˜æ•ˆä¸”å¯é ï¼Œå¼€å‘äººå‘˜èƒ½ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸æ˜¯è¢«ç¹ççš„éƒ¨ç½²æµç¨‹æ‰€å›°æ‰°ã€‚æˆ‘ä»¬å½“å‰çš„ç›®æ ‡å°±æ˜¯æ­å»ºè¿™æ ·ä¸€å¥—æµç¨‹ï¼Œ**æœ¬åœ°ä»£ç æäº¤ (Git) -> ä»£ç ä»“åº“ (GitLab/Gitee) -> Jenkins è‡ªåŠ¨æ„å»º -> éƒ¨ç½²åˆ°æœåŠ¡å™¨**ã€‚è€Œè¿™ä¸€åˆ‡çš„åŸºç¡€ï¼Œé¦–å…ˆæ˜¯**ç‰ˆæœ¬æ§åˆ¶**ã€‚

## äºŒã€Git ç‰ˆæœ¬æ§åˆ¶åŸºç¡€

### 2.1 ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼Ÿ

CI/CD çš„æºå¤´æ˜¯ä»£ç ï¼Œè€Œç®¡ç†ä»£ç çš„æ ¸å¿ƒå·¥å…·æ˜¯ **Git**ã€‚åœ¨æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶çš„å¹´ä»£ï¼Œå¦‚æœå¼ ä¸‰å’Œæå››åŒæ—¶ä¿®æ”¹äº†æœåŠ¡å™¨ä¸Šçš„ `nginx.conf` é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå‡ºç°æå››è¦†ç›–äº†å¼ ä¸‰çš„å†…å®¹ã€æ”¹é”™äº†æ— æ³•å›é€€åˆ°æ˜¨å¤©çš„ç‰ˆæœ¬ã€ä¸çŸ¥é“è°åœ¨ä½•æ—¶æ”¹äº†å“ªä¸€è¡Œç­‰é—®é¢˜ã€‚**ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ (VCS)** å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚å®ƒç»™æ–‡ä»¶çš„æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½æ‰“ä¸Šä¸€ä¸ªâ€œç‰ˆæœ¬å·â€ï¼ˆæ ‡ç­¾ï¼‰ï¼Œè®°å½•äº†è°åœ¨ä»€ä¹ˆæ—¶å€™æ”¹äº†ä»€ä¹ˆï¼Œè¿›è€Œæ”¯æŒå†å²è¿½è¸ªã€å¤šäººåä½œå’Œç‰ˆæœ¬å›é€€ã€‚

å¸‚é¢ä¸Šçš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š
- **é›†ä¸­å¼ï¼ˆå¦‚ SVNï¼‰**ï¼šæœ‰ä¸€ä¸ªä¸­å¤®æœåŠ¡å™¨ä¿å­˜æ‰€æœ‰ä»£ç ï¼Œå¤§å®¶éƒ½è¦è”ç½‘å»æäº¤ã€‚ç¼ºç‚¹æ˜¯å¦‚æœä¸­å¤®æœåŠ¡å™¨æŒ‚äº†ï¼Œå¤§å®¶éƒ½å¹²ä¸äº†æ´»ï¼Œä¸”ä¸¥é‡ä¾èµ–ç½‘ç»œã€‚

- **åˆ†å¸ƒå¼ï¼ˆå¦‚ Gitï¼‰**ï¼šæ²¡æœ‰ç»å¯¹çš„ä¸­å¤®æœåŠ¡å™¨ï¼Œ**æ¯ä¸ªäººç”µè„‘ä¸Šéƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“**ã€‚å³ä½¿æ–­ç½‘ï¼Œä½ ä¹Ÿèƒ½åœ¨æœ¬åœ°æäº¤ä»£ç ã€æŸ¥çœ‹å†å²ã€‚è¿™æ˜¯ç›®å‰æœ€ä¸»æµçš„æ–¹æ¡ˆã€‚

> Git æ˜¯ Linux ä¹‹çˆ¶ Linus Torvalds ä¸ºäº†ç®¡ç† Linux å†…æ ¸ä»£ç è€Œå¼€å‘çš„ã€‚å› ä¸ºä»–å¯¹å½“æ—¶çš„æ”¶è´¹ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶å¹¶ä¸æ»¡æ„ï¼Œä¸€æ€’ä¹‹ä¸‹ç”¨äº†ä¸¤å‘¨æ—¶é—´ç”¨ C è¯­è¨€æ‰‹æ’¸äº†ä¸€ä¸ª Gitã€‚å®ƒç»§æ‰¿äº† Linux çš„åŸºå› ï¼Œå¼€æºã€å…è´¹ã€é«˜æ•ˆä¸”å¼ºå¤§ã€‚

### 2.2 Git çš„å®‰è£…ä¸é…ç½®

Git æ”¯æŒ Windowsã€macOS å’Œ Linux ç­‰å¤šç§å¹³å°ã€‚

1. **Windows ç³»ç»Ÿå®‰è£…**

å¯¹äº Windows ç”¨æˆ·ï¼ŒGit å®˜æ–¹æä¾›äº†æ–¹ä¾¿çš„å®‰è£…åŒ…ï¼š

- **ä¸‹è½½**ï¼šè®¿é—® Git å®˜ç½‘ [git-scm.com](https://git-scm.com/)ï¼Œç‚¹å‡»é¦–é¡µçš„â€œInstall for Windowsâ€æŒ‰é’®ã€‚è¿›å…¥ä¸‹è½½é¡µé¢å¦‚å›¾ 15-2ï¼Œåœ¨æ­¤é¡µé¢ä¸­ï¼Œéœ€è¦**æ ¹æ®è‡ªå·±çš„ç”µè„‘æ¶æ„**é€‰æ‹©å¯¹åº”çš„å®‰è£…ç¨‹åºã€‚å¦‚æœæ˜¯å¸¸è§çš„ Intel/AMD èŠ¯ç‰‡ç”µè„‘ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»â€œClick here to downloadâ€ï¼›å¦‚æœæ˜¯ ARM æ¶æ„è®¾å¤‡ï¼Œåˆ™é€‰æ‹©â€œGit for Windows ARM64 Setupâ€ã€‚

<p align="center">
  <img src="./images/15_1_2.png" width="80%" alt="Git for Windows ä¸‹è½½é¡µé¢" />
  <br />
  <em>å›¾ 15-2 Git for Windows ä¸‹è½½é¡µé¢</em>
</p>

- **å®‰è£…**ï¼šåŒå‡»è¿è¡Œä¸‹è½½çš„ `.exe` æ–‡ä»¶ã€‚å®‰è£…å‘å¯¼ä¸­ä¼šæœ‰å¾ˆå¤šé€‰é¡¹ï¼ˆå¦‚ç¼–è¾‘å™¨é€‰æ‹©ã€è·¯å¾„ç¯å¢ƒé…ç½®ç­‰ï¼‰ï¼Œå¯¹äºåˆå­¦è€…ï¼Œ**ä¸€è·¯ç‚¹å‡» "Next" ä½¿ç”¨é»˜è®¤è®¾ç½®**å³å¯ã€‚ç­‰å¾…å®‰è£…è¿›åº¦æ¡èµ°å®Œï¼Œå°±èƒ½çœ‹åˆ°å¦‚å›¾ 15-3 æ‰€ç¤ºçš„å®‰è£…å®Œæˆç•Œé¢ã€‚

<p align="center">
  <img src="./images/15_1_3.png" width="80%" alt="Git å®‰è£…å®Œæˆç•Œé¢" />
  <br />
  <em>å›¾ 15-3 Git å®‰è£…å®Œæˆç•Œé¢</em>
</p>

2. **Linux ç³»ç»Ÿå®‰è£…**

å¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼ˆå¦‚ Ubuntu/CentOSï¼‰å·²ç»å†…ç½®äº† Gitã€‚å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œç›´æ¥æ£€æŸ¥æˆ–å®‰è£…ï¼š

```bash
# æ£€æŸ¥æ˜¯å¦å·²å®‰è£…
git --version

# å¦‚æœæœªå®‰è£…ï¼Œä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…
# Ubuntu/Debian
sudo apt install git
# CentOS/RHEL
sudo yum install git
```

3. **éªŒè¯å®‰è£…**

æ— è®ºæ˜¯åœ¨ Windows çš„ PowerShell/CMD è¿˜æ˜¯ Linux ç»ˆç«¯ä¸­ï¼Œå®‰è£…å®Œæˆåéƒ½å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯æ˜¯å¦æˆåŠŸï¼š

```bash
git --version
```

<p align="center">
  <img src="./images/15_1_4.png" width="80%" alt="Git ç‰ˆæœ¬éªŒè¯" />
  <br />
  <em>å›¾ 15-4 Git ç‰ˆæœ¬éªŒè¯</em>
</p>

4. **é…ç½®èº«ä»½ä¿¡æ¯**

å®‰è£…å®Œæˆåï¼Œå¿…é¡»å…ˆé…ç½®**ç”¨æˆ·èº«ä»½**ã€‚å› ä¸º Git æ˜¯åˆ†å¸ƒå¼çš„ï¼Œå®ƒéœ€è¦çŸ¥é“æäº¤ä»£ç çš„æ˜¯è°ã€‚

```bash
# é…ç½®ç”¨æˆ·å
git config --global user.name "YourName"

# é…ç½®é‚®ç®±
git config --global user.email "your_email@example.com"

# (å¯é€‰) å¼€å¯å‘½ä»¤è¡Œé¢œè‰²æ˜¾ç¤ºï¼Œè®©è¾“å‡ºæ›´å‹å¥½
git config --global color.ui true
```

> è¿™é‡Œçš„é…ç½®ä»…ç”¨äºåœ¨æäº¤å†å²ä¸­è®°å½•å¼€å‘è€…èº«ä»½ï¼Œ**å¹¶ä¸æ˜¯ç”¨äºç™»å½•è¿œç¨‹ä»£ç ä»“åº“çš„è´¦å·å¯†ç **ã€‚ä¸è¿‡ä¸ºäº†ä¾¿äºè¯†åˆ«**å»ºè®®å¡«å†™ä¸æ³¨å†Œä»£ç æ‰˜ç®¡å¹³å°ï¼ˆ GitHub/Gitee ç­‰ï¼‰æ—¶ä¸€è‡´çš„ç”¨æˆ·åå’Œé‚®ç®±**ã€‚

æŸ¥çœ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼š
```bash
git config --list
```

è¾“å‡ºå¦‚ä¸‹ï¼š
```bash
...
user.name=base-nlp
user.email=base-nlp@example.com
color.ui=true
```

### 2.3 åˆ›å»ºæœ¬åœ°ä»“åº“ä¸æ ¸å¿ƒå·¥ä½œæµ

Git çš„æ ¸å¿ƒæ“ä½œå›´ç»•ä¸‰ä¸ªåŒºåŸŸå±•å¼€ï¼Œå¦‚å›¾ 15-5 åˆ†åˆ«æ˜¯**å·¥ä½œåŒº**ã€**æš‚å­˜åŒº**å’Œ**ç‰ˆæœ¬åº“**ã€‚è¿™ä¸‰ä¸ªåŒºåŸŸååŒå·¥ä½œï¼Œæ„æˆäº† Git çš„åŸºæœ¬å·¥ä½œæµã€‚

<p align="center">
  <img src="./images/15_1_5.svg" width="80%" alt="Git å·¥ä½œæµ" />
  <br />
  <em>å›¾ 15-5 Git å·¥ä½œæµ</em>
</p>

1. **åˆå§‹åŒ–æœ¬åœ°ä»“åº“**

æ™®é€šçš„æ–‡ä»¶å¤¹åªæ˜¯æ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚è¦è®© Git ç®¡ç†å®ƒï¼Œéœ€è¦è¿›è¡Œåˆå§‹åŒ–ï¼š

```bash
mkdir base-nlp
cd base-nlp
git init
```

æ‰§è¡Œ `git init` åï¼Œç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ªéšè—çš„ `.git` æ–‡ä»¶å¤¹ã€‚è¿™ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯ Git çš„æ ¸å¿ƒæ•°æ®åº“ï¼ˆç‰ˆæœ¬åº“ï¼‰ï¼Œåƒä¸‡ä¸è¦æ‰‹åŠ¨åˆ é™¤æˆ–ä¿®æ”¹å®ƒã€‚

2. **â€œå·¥ä½œåŒºâ€åˆ°â€œæš‚å­˜åŒºâ€**

æˆ‘ä»¬åœ¨ `base-nlp` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ `test.py`ï¼š

```bash
echo "print('hello world')" > test.py
```

æ­¤æ—¶ï¼Œæ–‡ä»¶åœ¨**å·¥ä½œåŒº**ï¼ŒGit çŸ¥é“æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œä½†å®ƒè¿˜æ²¡è¢«è·Ÿè¸ªã€‚æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ `git status` çœ‹ä¸€ä¸‹å½“å‰çŠ¶æ€ï¼š

```bash
git status
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```bash
On branch master

No commits yet

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        test.py

nothing added to commit but untracked files present (use "git add" to track)
```

æ¥ä¸‹æ¥ï¼ŒæŠŠå®ƒæ·»åŠ åˆ°**æš‚å­˜åŒº**ï¼š

```bash
git add test.py
# æˆ–è€…ä½¿ç”¨ git add . å°†å½“å‰ç›®å½•æ‰€æœ‰ä¿®æ”¹åŠ å…¥æš‚å­˜åŒº
```

å†æ¬¡æŸ¥çœ‹çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶å·²ç»è¿›å…¥æš‚å­˜åŒºï¼Œç­‰å¾…æäº¤ï¼š

```bash
...
Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
        new file:   test.py
```

æš‚å­˜åŒºç›¸å½“äºä¸€ä¸ªâ€œç¼“å†²åœ°å¸¦â€æˆ–â€œè´­ç‰©è½¦â€ï¼Œå¯ä»¥åœ¨è¿™é‡Œç¡®è®¤è¿™ä¸€æ‰¹ä¿®æ”¹æ˜¯å¦å®Œæ•´ã€‚å¦‚æœå‘ç°æ”¹é”™äº†ï¼Œè¿˜å¯ä»¥ä»æš‚å­˜åŒºæ’¤å›ï¼Œè€Œä¸ä¼šæ±¡æŸ“æ­£å¼çš„ç‰ˆæœ¬å†å²ï¼š

```bash
# ä¸æƒ³æœ¬æ¬¡æäº¤ test.pyï¼Œå¯ä»¥æŠŠå®ƒä»æš‚å­˜åŒºæ’¤å›
git rm --cached test.py
```

> æš‚å­˜åŒºä¸­çš„ä¿¡æ¯ä¼šè¢«è®°å½•åœ¨ `.git/index` æ–‡ä»¶ä¸­ï¼Œé€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨ä¿®æ”¹æˆ–æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ã€‚

3. **â€œæš‚å­˜åŒºâ€åˆ°â€œç‰ˆæœ¬åº“â€**

ç¡®è®¤æ— è¯¯åï¼Œå°†æš‚å­˜åŒºçš„å†…å®¹æ­£å¼æäº¤åˆ°ä»“åº“ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼š

```bash
git commit -m "first commit: add test.py"
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```bash
[master (root-commit) 7db0bb0] first commit: add test.py
 1 file changed, 1 insertion(+)
 create mode 100644 test.py
```

æäº¤å®Œæˆåå†æ‰§è¡Œä¸€æ¬¡ `git status`ï¼Œä¼šçœ‹åˆ°å·¥ä½œåŒºå·²ç»â€œå¹²å‡€â€äº†ï¼š

```bash
On branch master
nothing to commit, working tree clean
```

**`-m` å‚æ•°å¾ˆé‡è¦**ï¼Œå®ƒä»£è¡¨æœ¬æ¬¡æäº¤çš„**å¤‡æ³¨ä¿¡æ¯**ã€‚æ¸…æ™°ã€æœ‰å«ä¹‰çš„å¤‡æ³¨èƒ½å¸®åŠ©æˆ‘ä»¬å°†æ¥åœ¨èŒ«èŒ«å†å²ç‰ˆæœ¬ä¸­å¿«é€Ÿæ‰¾åˆ°éœ€è¦çš„èŠ‚ç‚¹ã€‚æ¨èçš„å†™æ³•æ˜¯â€œ**åŠ¨è¯ + å¯¹è±¡**â€ï¼Œä¾‹å¦‚ï¼š

```bash
git commit -m "feat: æ–°å¢ NER é¢„æµ‹æ¥å£"
git commit -m "fix: ä¿®å¤ç™»å½•æ¥å£çš„ 500 é”™è¯¯"
git commit -m "refactor: æŠ½å–å…¬å…±çš„æ—¥å¿—å°è£…å‡½æ•°"
```

è€Œä¸‹é¢è¿™ç§å°±ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºå‡ ä¹æ²¡æœ‰ä»»ä½•ä¿¡æ¯é‡ï¼š

```bash
git commit -m "update"
git commit -m "test"
```

ä½†æ˜¯ï¼Œå˜¿å˜¿ã€‚å¤§å®¶ä¸è¦å­¦ğŸ‘‡

<p align="center">
  <img src="./images/15_1_6.png" width="80%" alt="åé¢æ•™æ" />
  <br />
  <em>å›¾ 15-5 åé¢æ•™æ</em>
</p>

### 2.4 ç‰ˆæœ¬è¿­ä»£ä¸å·®å¼‚å¯¹æ¯”

éšç€å¼€å‘è¿›è¡Œï¼Œæˆ‘ä»¬ä¼šä¸æ–­ä¿®æ”¹ä»£ç ã€‚æ¯”å¦‚ä¿®æ”¹ `test.py`ï¼Œæ›¿æ¢ä¸€è¡Œä»£ç ï¼š

```python
# åˆ é™¤ print('hello world')
print('hello nlp')
```

æ­¤æ—¶ä½¿ç”¨ `git status` æŸ¥çœ‹çŠ¶æ€ï¼ŒGit ä¼šæç¤ºæ–‡ä»¶å·²ä¿®æ”¹ï¼ˆmodifiedï¼‰ã€‚

```bash
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   test.py

no changes added to commit (use "git add" and/or "git commit -a")
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **`git diff`** æ¥æŸ¥çœ‹å…·ä½“æ”¹äº†ä»€ä¹ˆï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š

```bash
diff --git a/test.py b/test.py
index 75d9766..812e8d0 100644
--- a/test.py
+++ b/test.py
@@ -1 +1 @@
-print('hello world')
+print('hello nlp')
```

è¾“å‡ºä¸­ä¼šç”¨ç»¿è‰²åŠ å· `+` è¡¨ç¤ºæ–°å¢çš„è¡Œï¼Œçº¢è‰²å‡å· `-` è¡¨ç¤ºåˆ é™¤çš„è¡Œã€‚è¿™èƒ½å¸®åŠ©æˆ‘ä»¬åœ¨æäº¤å‰æœ€åç¡®è®¤ä¿®æ”¹å†…å®¹ã€‚ç¡®è®¤æ— è¯¯åï¼Œå†æ¬¡èµ°ä¸€éæµç¨‹ï¼š

```bash
git add .
git commit -m "v2: update print output"
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```bash
[master 3fa5369] v2: update print output
 1 file changed, 1 insertion(+), 1 deletion(-)
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸¤ä¸ªç‰ˆæœ¬ã€‚å¦‚æœå‘ç° v2 æœ‰ä¸¥é‡ bugï¼Œå¯ä»¥åˆ©ç”¨ Git æä¾›çš„èƒ½åŠ›å¿«é€Ÿå›é€€åˆ° v1ã€‚

### 2.5 æŸ¥çœ‹æäº¤å†å²ä¸ç‰ˆæœ¬å›é€€

é¡ºç€ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¥è¿›ä¸€æ­¥å­¦ä¹ å¦‚ä½•**æŸ¥çœ‹å†å²ç‰ˆæœ¬**ä»¥åŠ**å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬**ã€‚

1. **æŸ¥çœ‹æäº¤å†å²**

æœ€åŸºæœ¬çš„ç”¨æ³•ï¼š

```bash
git log
```

å®ƒä¼šæŒ‰ç…§**æ—¶é—´å€’åº**åˆ—å‡ºå½“å‰åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤ï¼ˆæœ€æ–°çš„åœ¨æœ€ä¸Šé¢ï¼‰ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š

```bash
commit 3fa5369... (HEAD -> master)
Author: base-nlp <base-nlp@example.com>
Date:   ...

    v2: update print output

commit 7db0bb0...
Author: base-nlp <base-nlp@example.com>
Date:   ...

    first commit: add test.py
```

- æœ€ä¸Šé¢ä¸€æ¡å°±æ˜¯å½“å‰åˆ†æ”¯ `master` çš„æœ€æ–°æäº¤ï¼Œ`HEAD -> master` è¡¨ç¤ºâ€œå½“å‰ HEAD æŒ‡å‘ master åˆ†æ”¯çš„è¿™ä¸ªæäº¤â€ã€‚  
- æ¯ä¸ªæäº¤å‰é¢é‚£ä¸€é•¿ä¸²åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå°±æ˜¯å”¯ä¸€çš„ **Commit IDï¼ˆæäº¤å“ˆå¸Œï¼‰**ï¼Œåé¢æ˜¯å†™çš„æäº¤è¯´æ˜ã€‚

å¦‚æœè§‰å¾—é»˜è®¤è¾“å‡ºå¤ªâ€œå•°å—¦â€ï¼Œå¯ä»¥ç”¨å‚æ•° `--pretty=oneline` å°†æ¯æ¡æäº¤å‹ç¼©æˆä¸€è¡Œï¼š

```bash
git log --pretty=oneline
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```bash
3fa5369... v2: update print output
7db0bb0... first commit: add test.py
```

2. **å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬**

ç›®å‰æˆ‘ä»¬å·²ç»åšäº†ä¸¤æ¬¡æäº¤ï¼š

- ç¬¬ä¸€æ¬¡ï¼š`first commit: add test.py`  
- ç¬¬äºŒæ¬¡ï¼š`v2: update print output`

æ­¤æ—¶ `git log` ç»“æœä¸­ï¼Œæœ€ä¸Šé¢çš„æ˜¯ v2ã€‚å¦‚æœæˆ‘ä»¬å‘ç° v2 æœ‰é—®é¢˜ï¼Œæƒ³å›é€€åˆ° v1ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```bash
git reset --hard HEAD^
```

å…¶ä¸­ï¼š

- `HEAD` ä»£è¡¨å½“å‰ç‰ˆæœ¬ï¼›  
- `HEAD^`ï¼ˆç­‰ä»·äº `HEAD~1`ï¼‰ä»£è¡¨**ä¸Šä¸€ä¸ªç‰ˆæœ¬**ï¼›  
- `HEAD~2` ä»£è¡¨ä¸Šä¸Šä¸ªç‰ˆæœ¬ï¼Œä»¥æ­¤ç±»æ¨ã€‚

æ‰§è¡Œ `git reset --hard HEAD^` åï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š

```bash
HEAD is now at 7db0bb0 first commit: add test.py
```

- è¿™è¡Œæç¤ºè¯´æ˜ `HEAD` ç°åœ¨æŒ‡å‘äº†æäº¤ `7db0bb0`ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡æäº¤ï¼‰ã€‚  
- åŒæ—¶ï¼Œ`HEAD` å’Œ `master` ä¼šä» v2 ç§»åŠ¨åˆ° v1ï¼Œå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å†…å®¹ä¹Ÿä¼šä¸€èµ·å›æ»šåˆ° v1 æ—¶çš„ä»£ç çŠ¶æ€ã€‚

æ­¤æ—¶ä½¿ç”¨ `cat test.py` æŸ¥çœ‹ `test.py`ï¼Œå°±ä¼šå‘ç°å®ƒçš„å†…å®¹å·²ç»æ¢å¤åˆ°ç¬¬ä¸€æ¬¡æäº¤æ—¶çš„æ ·å­ã€‚æ¥ä¸‹æ¥è¿è¡Œ `git log` ä¹Ÿåªä¼šçœ‹åˆ° v1 è¿™ä¸€æ¡æäº¤è®°å½•äº†ã€‚

é™¤äº†ç”¨ `HEAD^` è¿™ç§ç›¸å¯¹å†™æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ **Commit ID ç²¾ç¡®åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬**ã€‚æ¯”å¦‚åœ¨å·²ç»å›é€€åˆ° v1 ä¹‹åï¼Œå¦‚æœç¡®è®¤ v2 æ²¡é—®é¢˜ï¼Œæƒ³ä» v1 å›åˆ° v2ï¼Œå¯ä»¥æ‰§è¡Œï¼š

```bash
git reset --hard 3fa5369
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```bash
HEAD is now at 3fa5369 v2: update print output
```

è¿™é‡Œçš„ `3fa5369` å°±æ˜¯ `git log` è¾“å‡ºä¸­ v2 é‚£æ¡æäº¤å‰é¢çš„é‚£ä¸€æ®µå“ˆå¸Œå€¼ï¼ˆåªéœ€è¦å†™å‰å‡ ä½ï¼Œèƒ½å”¯ä¸€åŒ¹é…å³å¯ï¼‰ã€‚

> `--hard` ä¼šä¸¢å¼ƒå½“å‰å·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸­**å°šæœªæäº¤**çš„ä¿®æ”¹ï¼Œå®é™…å·¥ä½œä¸­ä½¿ç”¨å‰ä¸€å®šè¦ç¡®è®¤æ²¡æœ‰é‡è¦æ”¹åŠ¨æœªæäº¤ã€‚

`git reset` å…¶å®è¿˜æœ‰ä¸‰ç§å¸¸è§æ¨¡å¼ï¼Œå¯ä»¥ç®€å•å¯¹æ¯”ä¸€ä¸‹ï¼ˆäº†è§£å³å¯ï¼‰ï¼š

- `git reset --soft <commit>`ï¼š
 
  åªç§»åŠ¨ `HEAD`ï¼Œ**ä¿ç•™æš‚å­˜åŒºå’Œå·¥ä½œåŒº**ï¼Œé€‚åˆâ€œåˆå¹¶å¤šæ¬¡æäº¤â€ä¸ºä¸€æ¬¡ã€‚  
- `git reset --mixed <commit>`ï¼ˆé»˜è®¤ï¼‰ï¼š
 
  ç§»åŠ¨ `HEAD`ï¼Œé‡ç½®**æš‚å­˜åŒº**ï¼Œä½†**ä¿ç•™å·¥ä½œåŒº**çš„æ–‡ä»¶å†…å®¹ã€‚  
- `git reset --hard <commit>`ï¼š

  `HEAD`ã€æš‚å­˜åŒºå’Œå·¥ä½œåŒº**å…¨éƒ¨å›æ»š**åˆ°æŒ‡å®šæäº¤ï¼Œæœ€â€œå¹²å‡€â€ï¼Œä¹Ÿæœ€å±é™©ã€‚

3. **æŸ¥çœ‹æ‰€æœ‰æ“ä½œå†å²**

æœ‰æ—¶å€™æˆ‘ä»¬å·²ç»æ‰§è¡Œäº† `git reset --hard`ï¼Œåœ¨ `git log` é‡Œçœ‹ä¸åˆ°â€œè¢«å›é€€æ‰â€çš„æäº¤äº†ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ï¼š

```bash
git reflog
```

`git reflog` ä¼šè®°å½• **HEAD çš„æ¯ä¸€æ¬¡ç§»åŠ¨**ï¼ˆåŒ…æ‹¬ `commit`ã€`reset`ã€`checkout` ç­‰ï¼‰ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š

```bash
3fa5369 (HEAD -> master) HEAD@{0}: reset: moving to 3fa5369
7db0bb0 HEAD@{1}: reset: moving to HEAD^
3fa5369 (HEAD -> master) HEAD@{2}: commit: v2: update print output
7db0bb0 HEAD@{3}: commit (initial): first commit: add test.py
```

è¿™å››è¡Œä¾æ¬¡è®°å½•äº†æˆ‘ä»¬åˆšæ‰åšè¿‡çš„æ“ä½œï¼š

- `HEAD@{3}`ï¼šç¬¬ä¸€æ¬¡æäº¤ `first commit: add test.py`ï¼Œç”Ÿæˆ v1ï¼›  
- `HEAD@{2}`ï¼šç¬¬äºŒæ¬¡æäº¤ `v2: update print output`ï¼Œç”Ÿæˆ v2ï¼›  
- `HEAD@{1}`ï¼šæ‰§è¡Œ `git reset --hard HEAD^`ï¼Œä» v2 å›åˆ° v1ï¼›  
- `HEAD@{0}`ï¼šæ‰§è¡Œ `git reset --hard 3fa5369`ï¼Œåˆä» v1 å›åˆ° v2ã€‚

æ— è®ºæ˜¯ä» v2 å›åˆ° v1ï¼Œè¿˜æ˜¯åˆä» v1 å›åˆ° v2ï¼Œè¿™äº›â€œæ—¶å…‰æ—…è¡Œâ€éƒ½ä¼šè¢« `git reflog` è®°å½•ä¸‹æ¥ã€‚å°†æ¥åªè¦åœ¨ `git reflog` ä¸­æ‰¾åˆ°ç›®æ ‡çŠ¶æ€å‰é¢çš„ Commit IDï¼Œå°±å¯ä»¥å†æ¬¡é€šè¿‡ `git reset --hard <commit_id>` æŠŠä»£ç â€œç©¿è¶Šå›å»â€ã€‚æ‰€ä»¥ï¼Œ`git log` ä¸»è¦ç”¨æ¥â€œçœ‹ç‰ˆæœ¬å†å²â€ï¼Œ`git reflog` æ›´åƒæ˜¯è®°å½•**æ‰€æœ‰å…³é”®æ“ä½œ**çš„â€œé»‘åŒ£å­â€ï¼Œå¯ä»¥åœ¨â€œæ‰‹æ»‘ resetâ€ ä¹‹åæ•‘å‘½ã€‚
